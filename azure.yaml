# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: stamps-management-portal
metadata:
  template: stamps-management-portal@0.0.1-beta

services:
  portal:
    project: ./management-portal/src/Portal
    language: dotnet
    host: containerapp
    docker:
      path: ./Dockerfile
      context: .
  dab:
    project: ./management-portal/dab
    language: docker
    host: containerapp
    docker:
      path: ./Dockerfile
      context: .

infra:
  path: ./management-portal/infra
  parameters:
    portalImage: "${AZURE_CONTAINER_REGISTRY_ENDPOINT}/stamps-portal:latest"
    dabImage: "${AZURE_CONTAINER_REGISTRY_ENDPOINT}/stamps-dab:latest"

hooks:
  postdeploy:
    shell: pwsh
    run: |
      Write-Host "ðŸŽ‰ Management Portal deployed successfully!"
      Write-Host "Portal URL: $($env:AZURE_PORTAL_URL)"
      Write-Host "DAB URL: $($env:AZURE_DAB_URL)"
      Write-Host ""
      Write-Host "Next steps:"
      Write-Host "1. Configure Azure Entra ID authentication"
      Write-Host "2. Set up monitoring alerts"
      Write-Host "3. Configure custom domain (optional)"
